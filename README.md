# AI女友 · 主动对话插件 (v1.0)
（必读，本插件为geminicli完成，作者的代码水平约为hellowrold水平。甚至连readme.md文档都是gemini生成，作者基本没有修改能力，全靠ai。
故此插件为三无产品，作者为典型的安卓人，安卓思维，安卓学历。考虑源码可能有一定参考价值，故上传，出bug别骂我就行，我其实连git上传都不太会。）


这是一款为 AstrBot 设计的、高度拟人化的主动对话插件。她不再是一个只会等待指令的冰冷助手，而是一个会想你、会关心你、拥有自己“作息”的智能伴侣。

## ✨ 核心功能

- **智能对话**：当她发现你长时间没有和她说话时，她会主动开启一段对话。她会智能地分析你们的聊天记录，来决定是延续之前未完的话题，还是开启一段全新的分享。

- **作息规律**：她拥有可配置的“休眠时间”。在休眠时段内触发的主动对话，会被智能地推迟到她“睡醒”之后（再随机延迟0-1小时）发送，完美模拟真实作息。

- **双核模型**：你可以为“话题创意”（Huati）和“聊天对话”（Chat）指定不同的模型，让最合适的模型做最擅长的事，以达到最佳效果。

- **高度可定制**：从触发时间、休眠时段，到AI女友的人设、说话的语气（通过修改提示词），所有核心参数都可以在WebUI配置面板中轻松修改，无需触碰代码。

- **手动触发**：作为管理员，你可以随时使用 `/girlfriend_talk` 指令，让她立即和你说说话，方便调试和互动。

- **无缝集成**：自动支持WebUI聊天窗口，无需任何额外配置。（webui似乎有一定bug，astrbot应该有拦截的安全机制阻止了主动回复。所以建议使用其他消息平台。）

## ⚙️ 配置指南

在AstrBot的“插件”页面找到本插件，点击“配置”，你会看到以下设置项：

### 1. 模型配置 (Providers)

- **[第一步] 话题生成模型ID (Huati)**
  - **作用**：负责“灵光一闪”，生成“今日趣事”作为备选聊天话题。
  - **建议**：可以使用一个响应速度快、富有创造力的模型。
  - **此项为必填。**

- **[第二步] 聊天生成模型ID (Chat)**
  - **作用**：负责最终的对话内容生成，是与你直接交流的模型。
  - **建议**：使用你主要的、对话能力最强的模型。
  - **此项为选填**，如果留空，将默认使用与“话题生成”相同的模型。

### 2. 提示词配置 (Prompts)

这是定制AI女友灵魂的地方！你可以修改默认的提示词，来改变她的性格、名字、说话方式等。

- **话题生成提示词 (Huati Prompt)**
  - **作用**：给“话题生成模型”下达指令，告诉它生成什么样的话题。

- **聊天生成提示词 (Chat Prompt)**
  - **作用**：最核心的提示词，它整合了所有信息（人设、背景、趣事、历史记录），并指示“聊天生成模型”如何进行最终表达。
  - **注意**：此提示词必须包含以下三个占位符，程序会自动替换它们：
    - `{inactive_hours}`：不活跃的小时数
    - `{todays_event}`：由Huati模型生成的“今日趣事”
    - `{history_text}`：最近的聊天记录

### 3. 触发规则 (Rules)

- **不活跃小时数**：她发现你多久没说话会主动找你。
- **检查间隔(分钟)**：插件每隔多久检查一次你的状态。
- **休眠开始/结束时间**：她“睡觉”和“睡醒”的时间。在休眠时段内，自动触发的对话会被推迟到睡醒后发送。

### 4. 白名单用户ID列表

- **作用**：插件只会对列表内的用户ID生效。**注意：WebUI聊天窗口会自动生效，无需配置。**
- **格式**：主要用于QQ等平台，请填写用户的QQ号，并确保它是字符串格式，例如：`["12345678", "87654321"]`。

## 🚀 如何使用

1.  **自动模式**：配置好后，正常和她聊天即可。当你们的对话中断超过设定的“不活跃小时数”后，她会在合适的时机（非休眠时间）再次找你。

2.  **手动模式**：在任意聊天窗口（包括WebUI和QQ）输入 `/girlfriend_talk`，可以立即触发一次主动对话，该指令会忽略休眠时间的限制。